@font-face {
	font-display: swap;
	font-family: "Geist Mono";
	font-style: normal;
	font-weight: 400;
	src: url("geist-mono-v4-latin-regular.woff2") format("woff2");
}

@layer reset, theme, layout, components, utilities;

@layer reset {
	*,
	*::before,
	*::after {
		margin: 0;
		padding: 0;
		box-sizing: border-box;
	}

	html {
		scroll-behavior: smooth;
	}
}

@layer theme {
	:root {
		/* Colors - Light mode */
		--color-bg: #e8e6e1;
		--color-glow: #e8e6e1;
		--color-section: #f5f4f0;
		--color-text: #2a2a2a;
		--color-text-muted: #5a5a5a;
		--color-border: #d0cec9;
		--color-input: rgb(245 244 240 / 0.95);
		--color-code: #eae8e3;
		--color-error-bg: #ffeef0;
		--color-error-border: #f97583;

		--syntax-keyword: #d73a49;
		--syntax-operator: #d73a49;
		--syntax-string: #22863a;
		--syntax-number: #005cc5;
		--syntax-field: #6f42c1;

		--particle-red: #c45b4d;
		--particle-blue: #4a7c8c;
		--particle-green: #5c8a5e;
		--particle-orange: #c4854d;
		--particle-purple: #7c5c8a;

		/* Spacing scale based on 4px baseline */
		--space-1: 0.25rem; /* 4px */
		--space-2: 0.5rem; /* 8px */
		--space-3: 0.75rem; /* 12px */
		--space-4: 1rem; /* 16px */
		--space-5: 1.5rem; /* 24px */
		--space-6: 2rem; /* 32px */
		--space-8: 3rem; /* 48px */
		--space-10: 4rem; /* 64px */
		--space-12: 5rem; /* 80px */

		--radius-sm: 3px;
		--radius-md: 4px;
		--radius-lg: 6px;

		--transition-fast: 0.15s;
		--transition-base: 0.2s;
		--transition-slow: 0.5s;

		--font-mono: "Berkeley Mono", "Geist Mono", Monaco, "Courier New", monospace;

		@media (prefers-color-scheme: dark) {
			--color-bg: #1a1a1a;
			--color-glow: #2a2a2a;
			--color-section: #232323;
			--color-text: #e5e5e5;
			--color-text-muted: #a0a0a0;
			--color-border: #3a3a3a;
			--color-input: rgb(30 30 30 / 0.95);
			--color-code: #2a2a2a;
			--color-error-bg: #3d1f1f;

			--syntax-keyword: #ff7b8a;
			--syntax-operator: #ff7b8a;
			--syntax-string: #7ee787;
			--syntax-number: #79c0ff;
			--syntax-field: #d2a8ff;

			--particle-red: #e07060;
			--particle-blue: #5a9cac;
			--particle-green: #6ca06e;
			--particle-orange: #e0a060;
			--particle-purple: #9c7caa;
		}
	}

	body {
		font-family:
			-apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans", Helvetica, Arial, sans-serif,
			"Apple Color Emoji", "Segoe UI Emoji";
		background-color: var(--color-bg);
		color: var(--color-text);
		line-height: 1.6;
		font-size: 14px;
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
		overflow-x: clip;
	}
}

@layer layout {
	#grid-canvas {
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		z-index: 0;
		transform: translateZ(0);
		will-change: transform;
	}

	.page {
		position: relative;
		z-index: 1;
		contain: layout style paint;
	}

	.hero {
		min-block-size: 100vh;
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		padding: var(--space-10) var(--space-5);
		pointer-events: none;

		& > * {
			pointer-events: auto;
		}
	}

	.content-section {
		background: var(--color-section);
		padding-block: var(--space-12);
		padding-inline: var(--space-5);

		&.alt {
			background: var(--color-bg);
		}
	}

	.section-inner {
		max-inline-size: 680px;
		margin-inline: auto;
	}

	footer {
		padding: var(--space-10) var(--space-5);
		text-align: center;
		background: transparent;
		border-block-start: 1px solid var(--color-border);

		& .links {
			display: flex;
			gap: var(--space-6);
			justify-content: center;
			margin-block-end: var(--space-4);

			& a {
				display: flex;
				align-items: center;
				gap: var(--space-1);
				color: var(--color-text-muted);
				text-decoration: none;
				font-size: 0.875rem;
				transition: color var(--transition-base);

				&:hover {
					color: var(--color-text);
				}

				& .icon {
					width: 1rem;
					height: 1rem;
					fill: currentColor;
				}
			}
		}
	}

	.copyright {
		font-size: 0.75rem;
		color: var(--color-text-muted);
	}
}

@layer components {
	header {
		text-align: center;
		margin-block-end: var(--space-6);
	}

	h1 {
		font-size: clamp(2.5rem, 10vw, 4rem);
		font-weight: 600;
		letter-spacing: -0.03em;
		margin-block-end: var(--space-2);
	}

	h2 {
		font-size: 1.75rem;
		font-weight: 600;
		margin-block-end: var(--space-5);
		letter-spacing: -0.01em;
	}

	h3 {
		font-size: 1rem;
		font-weight: 500;
		margin-block-start: var(--space-6);
		margin-block-end: var(--space-3);
		color: var(--color-text-muted);
	}

	p {
		color: var(--color-text-muted);
		margin-block-end: var(--space-5);
	}

	.tagline {
		font-size: 1rem;
		color: var(--color-text-muted);
	}

	.filter-container {
		position: relative;
		display: flex;
		align-items: center;
		gap: var(--space-2);
		inline-size: 100%;
		max-inline-size: 540px;
		margin-block-end: var(--space-5);
		margin-inline-start: calc(2rem + var(--space-2));
		overflow: visible;
	}

	.filter-input-wrapper {
		position: relative;
		display: grid;
		flex: 1;
		min-inline-size: 0;
		background: var(--color-input);
		border: 1px solid var(--color-border);
		border-radius: var(--radius-lg);
		box-shadow: 0 2px 8px rgb(0 0 0 / 0.06);
		overflow: visible;
	}

	.filter-input,
	.filter-highlighted {
		font-family: var(--font-mono);
		padding: var(--space-4) 3.75rem var(--space-4) var(--space-5);
		font-size: 1rem;
		line-height: 1.5;
	}

	.filter-input {
		inline-size: 100%;
		background: transparent;
		border: none;
		outline: none;
		color: transparent;
		caret-color: var(--color-text);
		position: relative;
		z-index: 2;
		resize: none;
		overflow: visible;
		min-block-size: 3.375rem;
		field-sizing: content;

		&::placeholder {
			color: var(--color-text-muted);
		}
	}

	.filter-highlighted {
		position: absolute;
		inset: 0;
		white-space: pre-wrap;
		word-wrap: break-word;
		overflow: visible;
		pointer-events: none;
		z-index: 1;
	}

	.filter-stats {
		position: absolute;
		right: var(--space-2);
		bottom: var(--space-2);
		font-family: var(--font-mono);
		font-size: 0.75rem;
		color: var(--color-text-muted);
		pointer-events: auto;
		cursor: help;
		z-index: 3;
		padding: var(--space-1) var(--space-2);
		border-radius: var(--radius-sm);
		background: var(--color-input);

		&:empty {
			display: none;
		}
	}

	.randomize-btn {
		flex-shrink: 0;
		display: flex;
		align-items: center;
		justify-content: center;
		width: 2rem;
		height: 2rem;
		padding: 0;
		background: transparent;
		border: 1px solid transparent;
		border-radius: var(--radius-md);
		color: var(--color-text-muted);
		cursor: pointer;
		transition:
			color var(--transition-fast),
			border-color var(--transition-fast);

		& .icon {
			width: 1.25rem;
			height: 1.25rem;
			fill: currentColor;
		}

		&:hover {
			color: var(--color-text);
			border-color: var(--color-border);
		}
	}

	.hints {
		font-size: 0.6875rem;
		border-radius: var(--radius-md);
		border: 1px solid var(--color-border);
		backdrop-filter: blur(4px);
		margin-block-end: var(--space-6);
		border-collapse: separate;
		border-spacing: 0;
		inline-size: auto;

		& caption {
			caption-side: top;
			padding-block-end: var(--space-2);
			font-size: 0.6875rem;
			font-family: var(--font-sans);
		}

		& td {
			border: none;
		}

		& .hint-name {
			background: var(--color-code);
			padding: var(--space-1) var(--space-2);
		}

		& .hint-values {
			background: var(--color-input);
			padding: var(--space-1) var(--space-2);
		}

		& tr:first-child .hint-name {
			border-start-start-radius: var(--radius-md);
		}

		& tr:first-child .hint-values {
			border-start-end-radius: var(--radius-md);
		}

		& tr:last-child .hint-name {
			border-end-start-radius: var(--radius-md);
		}

		& tr:last-child .hint-values {
			border-end-end-radius: var(--radius-md);
		}
	}

	.scroll-hint {
		text-decoration: none;
		font-size: 0.8125rem;
		transition: color var(--transition-base);
		margin-block-start: var(--space-5);

		&:hover {
			color: var(--color-text);
		}
	}

	.code-block {
		background: var(--color-code);
		border: 1px solid var(--color-border);
		border-radius: var(--radius-lg);
		padding: var(--space-4) var(--space-5);
		margin-block-end: var(--space-5);
		overflow-x: auto;

		& pre,
		& code {
			font-family: var(--font-mono);
			font-size: 0.8125rem;
			line-height: 1.6;
		}

		& pre {
			margin: 0;
			background: transparent !important;
		}

		/* Shiki dual-theme support */
		@media (prefers-color-scheme: dark) {
			& span {
				color: var(--shiki-dark) !important;
			}
		}
	}

	.syntax-example {
		font-family: var(--font-mono);

		@media (prefers-color-scheme: dark) {
			& span {
				color: var(--shiki-dark) !important;
			}
		}
	}

	table {
		inline-size: 100%;
		border-collapse: collapse;
		font-size: 0.8125rem;

		& thead {
			border-block-end: 2px solid var(--color-border);
		}

		& th {
			text-align: start;
			padding: var(--space-3) var(--space-2);
			font-weight: 600;
		}

		& td {
			padding: var(--space-3) var(--space-2);
			border-block-end: 1px solid var(--color-border);

			& code {
				font-family: var(--font-mono);
				background: var(--color-code);
				padding: var(--space-1) var(--space-2);
				border-radius: var(--radius-sm);
				font-size: 0.75rem;
			}
		}

		& tbody tr:last-child td {
			border-block-end: none;
		}
	}

	.tabs {
		margin-block-start: var(--space-4);
		display: flex;
		flex-wrap: wrap;
	}

	.tab-radio {
		position: absolute;
		opacity: 0;
		pointer-events: none;
	}

	.tab-label {
		padding: var(--space-2) var(--space-4);
		background: var(--color-section);
		border: 1px solid var(--color-border);
		border-radius: 0;
		font-size: 0.8125rem;
		cursor: pointer;
		transition: all var(--transition-fast);
		margin-inline-end: -1px;
		margin-block-end: -1px;
		position: relative;
		order: -1;

		&:hover {
			color: var(--color-text);
			background: var(--color-bg);
		}

		&:first-of-type {
			border-top-left-radius: var(--radius-lg);
		}

		&:last-of-type {
			margin-inline-end: 0;
			border-top-right-radius: var(--radius-lg);
		}
	}

	.tab-radio:checked + .tab-label {
		background: var(--color-code);
		color: var(--color-text);
		border-block-end-color: var(--color-code);
		z-index: 1;
	}

	.tab-panel {
		display: none;
		inline-size: 100%;

		& .code-block {
			margin: 0;
			border-top-left-radius: 0;
			border-top-right-radius: 0;
		}
	}

	#tab-core:checked ~ #panel-core,
	#tab-sql:checked ~ #panel-sql,
	#tab-js:checked ~ #panel-js {
		display: block;
	}

	.perf-bars {
		margin-block: var(--space-6);
	}

	.perf-item {
		display: grid;
		grid-template-columns: 1fr auto;
		grid-template-rows: auto auto;
		gap: var(--space-1) var(--space-4);
		margin-block-end: var(--space-6);
	}

	.perf-bar-wrap {
		grid-column: 1 / -1;
		block-size: 0.5rem;
		background: var(--color-border);
		border-radius: var(--radius-md);
		overflow: hidden;
	}

	.perf-label {
		font-size: 0.8125rem;
	}

	.perf-value {
		font-size: 0.875rem;
		font-weight: 500;
		text-align: end;
		color: var(--color-text);
	}

	.perf-query {
		grid-column: 1 / -1;
		font-family: var(--font-mono);
		font-size: 0.6875rem;
		opacity: 0.7;
	}

	.perf-bar {
		block-size: 100%;
		background: var(--color-text);
		border-radius: var(--radius-md);
		transition: inline-size var(--transition-slow) ease-out;
	}
}

@layer utilities {
	.fl-error {
		background: var(--color-error-bg);
		border-block-end: 2px wavy var(--color-error-border);
	}

	.error-tooltip {
		position: absolute;
		inset-block-start: 0;
		inset-inline-start: 50%;
		translate: -50% calc(-100% - var(--space-2));
		padding: var(--space-2) var(--space-3);
		background: var(--color-text);
		color: var(--color-bg);
		font-size: 0.75rem;
		white-space: nowrap;
		border-radius: var(--radius-md);
		opacity: 0;
		pointer-events: none;
		z-index: 100;
	}

	.filter-input:focus ~ .error-tooltip:not([hidden]) {
		opacity: 1;
	}

	.fl-error-eol {
		display: inline-block;
		inline-size: 6px;
		block-size: 1em;
		vertical-align: text-bottom;
	}

	.fl-keyword {
		color: var(--syntax-keyword);
	}

	.fl-operator {
		color: var(--syntax-operator);
	}

	.fl-string {
		color: var(--syntax-string);
	}

	.fl-number {
		color: var(--syntax-number);
	}

	.fl-field {
		color: var(--syntax-field);
	}

	.text-glow {
		text-shadow:
			0 0 8px var(--color-glow),
			0 0 16px var(--color-glow),
			0 0 24px var(--color-glow),
			0 0 32px var(--color-glow),
			0 0 48px var(--color-glow),
			0 0 64px var(--color-glow);
	}

	.icon {
		filter: drop-shadow(0 0 8px var(--color-bg)) drop-shadow(0 0 16px var(--color-bg))
			drop-shadow(0 0 24px var(--color-bg));
	}

	.font-mono {
		font-family: var(--font-mono);
	}

	.text-muted {
		color: var(--color-text-muted);
	}

	.tooltip:not(.filter-stats) {
		position: relative;
	}

	.tooltip::after {
		content: attr(aria-label);
		position: absolute;
		bottom: calc(100% + var(--space-2));
		left: 50%;
		translate: -50% 0;
		padding: var(--space-1) var(--space-2);
		background: var(--color-text);
		color: var(--color-bg);
		font-family: var(--font-mono);
		font-size: 0.75rem;
		white-space: nowrap;
		border-radius: var(--radius-md);
		opacity: 0;
		pointer-events: none;
		transition: opacity var(--transition-fast);
		z-index: 100;
	}

	.tooltip:hover::after {
		opacity: 1;
	}
}

.tab-short {
	display: none;
}

@media (width <= 600px) {
	.hints {
		flex-direction: column;
		align-items: center;
	}

	.filter-input,
	.filter-highlighted {
		font-size: 0.875rem;
		padding: var(--space-3) 3.125rem var(--space-3) var(--space-4);
	}

	.tab-full {
		display: none;
	}

	.tab-short {
		display: inline;
	}

	.tab-label {
		flex: 1;
		text-align: center;
		padding: var(--space-2) var(--space-4);
	}
}
